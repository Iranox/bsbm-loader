# bsbmloader

# show help

With ``-h `` or ``-help`` you will see all parameters.

# Supported databases

Following databases are supported:

* Mysql
* Posgre
* MongoDB
* CouchDB
* ElasticSearch 1.4
* Excel

## init a MySQL database with bsbm data

Start import data to a MySQL database. It will use sql files, which are generated by bsbm.

``-importToMysql -u root -p password  -urlMysql jdbc:mysql://localhost/benchmark ``

 If you want to use another file, you can use

``-importToMysql -u root -p password  -urlMysql jdbc:mysql://localhost/benchmark -file pathToFolder``

**Important**: The database in the jdbc muss exist. The loader have problems with large SQL files (above 5 MB)

## MongoDB
### parse to MongoDB
This will copy the RDBS tables to MongoDB. If the database not exist, it will be generate a new database.

``-parseToMongo -u root -p password  -urlMysql jdbc:mysql://localhost/benchmark -hostNosql localhost -portNosql 27017 -databaseName bsbm``  

If you have this database and collections, you can use this :

``-parseToMongo -u root -p password  -urlMysql jdbc:mysql://localhost/benchmark -hostNosql localhost -portNosql 27017 -databaseName bsbm -d``

The collections will be removed.   

### dematerialize n:1

This command dematerialize a simple N:1 relationship. It create a new collection target_mat and copy the new data in this collection.

``-materializeMongo -target offer -source product -fk product -pk nr -hostNosql localhost -portNosql 27017 -databaseName bsbm``

If exist a target_mat collection, you should run this command.  

``-materializeMongo -target offer -source product -fk product -pk nr -hostNosql localhost -portNosql 27017 -databaseName bsbm -d``

This will delete the collection.


### demateriazile n:m

``-materializeMongo -hostNosql localhost -portNosql 27017 -databaseName bsbm -source product -fk productFeature -join productfeatureproduct -secondSource productfeature -pkSecond nr -pk nr -secondFkey product``

## CouchDB
### parse to CouchDB
``-parseToMongo -u root -p password  -urlMysql jdbc:mysql://localhost/benchmark -hostNosql localhost -portMongo 27017 -databaseName bsbm``

### demateriazile n:1

``-materializeCouch -target offer -source product -fk product -pk nr -hostNosql localhost -portNosql 5986 -databaseName bsbm -userCouch admin  -passwordCouch password``

### demateriazile n:m  
``-materializeCouch -hostNosql localhost -portNosql 5986 -databaseName bsbm -source product -fk productFeature -join productfeatureproduct -secondSource productfeature -pkSecond nr -pk nr -secondFkey product -userCouch admin  -passwordCouch password``

### get a row (CouchDB)
To get all ids

``curl -X GET http://username:password@host:port/table/_all_docs``

To get a value

``curl -X GET http://username:password@host:port/table/id``

## Excel
### parse to Excel

The excel file must exist.  
``-parseToExcel -u root -p password -urlMysql jdbc:mysql://localhost/benchmark -excelFile  C:\Users\username\Desktop\Test.xlsx``

At the moment, bsbmloader does not support demateriazile an excel file.

## ElasticSearch
### parte to ElasticSearch   

``-parseToElastic -u root -p password -urlMysql jdbc:mysql://localhost/benchmark -hostNosql localhost -portNosql 27017 -databaseName bsbm``

### Get 1000 rows
http://127.0.0.1:9200/bla/_search/?size=1000&pretty=1

## Build and execute
### Build

You can build this programm with :
``cd loader``
``mvn package -DskipTests``

You can see the result in the target folger.

## Parse to JDBC

You can parse the databast to MySQL or PostgeSQL 

-parseToJdbc -u root -p password -urlMysql  jdbc:mysql://localhost/benchmark -hostNosql localhost -portNosql 9200 -databaseName bsbm -targetUrl  jdbc:postgresql://127.0.0.1:5432/postgres
-user postgres   -password password

## Run

You can run the loader with :
git add pom.xml 
``java -jar bsbmloader-jar-with-dependencies.jar -parseToMongo -u root -p password -urlMysql jdbc:mysql://localhost/benchmark -hostNosql localhost -portNosql 27017 -databaseName bsbm``


